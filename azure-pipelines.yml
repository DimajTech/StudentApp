trigger:
  branches:
    include:
      - main

pool:
  name: "Default"

steps:
  - task: UseDotNet@2
    inputs:
      packageType: "sdk"
      version: "8.0.x"

  - script: |
      dotnet restore StudentApp.sln
    displayName: "Restore dependencies"

  - script: |
      dotnet build StudentApp.sln --configuration Release
    displayName: "Build Solution"

  - script: |
      start /B dotnet run --project StudentApp/StudentApp.csproj --no-build
      ping 127.0.0.1 -n 20 > nul
    displayName: "Start StudentApp"

  - script: |
      dotnet test StudentApp.Tests/StudentApp.Tests.csproj --no-restore --verbosity normal
    displayName: "Run Selenium Tests"
